<!DOCTYPE html>
<html id="html-page" lang="en">

<!-- ///////////////////////////////////////////////////////////////////////////////// -->
<!-- // Powered by ENG Muhammad Abdullah El Nahtta//////////////////////////////////// -->
<!-- // This frameWork  created bye ENG Muhammad Abdullah El Nahtta/////////////////// -->
<!-- // Powered by ENG Muhammad Abdullah El Nahtta//////////////////////////////////// -->
<!-- ///////////////////////////////////////////////////////////////////////////////// -->
<!-- // you can contact me through mobile number 201093001070 or lanline 20 48 2327352 -->
<!-- ///////////////////////////////////////////////////////////////////////////////// -->
<!-- //////////////////////////////&&&&&&&&&&&&&&&&,@///////////////////////////////// -->
<!-- ////////////////////////////&&&&&&&&&&&&&&&&&@&&&%&%///////////////////////////// -->
<!-- ///////////////////////////*%&%&&%%%%#%%%%%%&%&&&&&&&//////////////////////////// -->
<!-- ///////////////////////////&&&/,,,,,,...*,*,,***//(&&&%////////////////////////// -->
<!-- /////////////////////////%&%&,,.....,,,,,,,,,,****//%&&////////////////////////// -->
<!-- /////////////////////////%%#*,..... .........,,,,***/#&&///////////////////////// -->
<!-- /////////////////////////&#*...........,...,,,,,,,****%&///////////////////////// -->
<!-- /////////////////////////%(,....,...,......,,,###((***/&&*/////////////////////// -->
<!-- ///////////////////////..,#*,&#/,****@&*,,%/((#((/((*@#*,*/////////////////////// -->
<!-- ///////////////////////.,..,@,,*(.&@(/,/.,@/((((*//*,*%**//////////////////////// -->
<!-- /////////////////////////,,(,/..,,**,./..,**@,**,%&***//*//////////////////////// -->
<!-- //////////////////////////.(,....,,,.....,******,,,,*/#,.//////////////////////// -->
<!-- ////////////////////////////(....,(...*..,*//***/#*//%/////////////////////////// -->
<!-- /////////////////////////////%#,,//#(///((((#*//%%&/(%&////////////////////////// -->
<!-- /////////////////////////////#/#/*(..,,,,*,*//**#/%&&./////////////////////////// -->
<!-- ///////////////////////////////%#*/,...,,///****#&&&///////////////////////////// -->
<!-- ///////////////////////////////,*%%#/(*//#(###%&&#/*,//////////////////////////// -->
<!-- //////////////////////////////,&..*/&&%&&&&&&&&#***,.&&////////////////////////// -->
<!-- ////////////////////////////@%///(....,,*///*****,//..&&&&&&&&&&@//////////////// -->
<!-- ///////////////////////&&&&&%%%/////*...,,,*,,,////...&&&&&&&&&&&&&&&&&&&&&////// -->
<!-- ///////////////&%%%%%%%&&&%%%%%/////////,,,,////////.,&&&&&&&&&&&&&&&&&&&&&&&&&// -->
<!-- /////////%%%&&&%%%%%%%%%%&%%%%%%//////@&#%%&&&&%//...,&&&&&&&%&&&&%%%&&%&&&&&&&// -->
<!-- //////%&&&%%%%%%%###%%%#%%%%%%%./////,(/%#&&&&,.,# ...(&&&&&&&%&&&%%%%%%%%%%%&&// -->
<!-- //////%%%%%%%#######%####%%%%%%%///.../*%#&&&,....///.*&&&&%&%%&&&&&%%%%%%%%%&&// -->
<!-- //////%%################%%%%%%%&.////////%%%&,..../////&&&%&%%%%&&&&&%%%%&&%&&%// -->
<!-- //////%%###(#(((#(#(####%%%%%%%&,///////%%%&&&.../////.&&&&%%%%%&&&&&&&&&&&&&&&// -->
<!-- ///////////////////////////////////////////////////////////////////////////////// -->
<!-- // you can contact me through mobile number 201093001070 or lanline 20 48 2327352 -->
<!-- ///////////////////////////////////////////////////////////////////////////////// -->
<!-- // Powered by ENG Muhammad Abdullah El Nahtta//////////////////////////////////// -->
<!-- // This frameWork  created bye ENG Muhammad Abdullah El Nahtta/////////////////// -->
<!-- // Powered by ENG Muhammad Abdullah El Nahtta//////////////////////////////////// -->
<!-- ///////////////////////////////////////////////////////////////////////////////// -->
      <head>


            <?php

            include("includes/classautoloader.inc.php");

            session_start();
            error_reporting(0);   

            $user = $_SESSION['user'];
            if ($user === NULL) {
              header("location:logout");
            }
            ///////////////////////////////////////
            // getting lanaguage and theme style
            //////////////////////////////////////
            $user_lang = new Language();
            $language =$user_lang->get_user_langauage($user->username);
            $_SESSION['language'] = $language;

            $user_theme = new Theme();
            $theme =$user_theme->get_user_theme($user->username);
            $_SESSION['theme'] = $theme;

            if ($language==='ar') {
              include 'lang/ar.php';
            } else {
              include 'lang/en.php';
            }

            //validate Session token 
            $validate_session_token = $user->validate_session_token($user->username,"web", $user->session_token);
            $validate_token_session_count = $user->validate_token_session_count($user->username,"web");
            if ($validate_session_token===false) {
              header("location:auth_token/token.logout.process");
            } 
            if ($validate_token_session_count===false) {
              header("location:auth_token/process");
            } 


            ///////////////////////////////////////
            // end lanaguage and theme style
            //////////////////////////////////////

            // getting the Authoriszed Navgationbar
            $navBar         = new NavBarMenu();
            $userRole       = new UserRole();

            ////////////////////////////    
            // getting page Title 
            /////////////////////////////
            if (isset($_GET['module'])) {
                  if ($navBar->check_module_authorization($user->username, $_GET['module'])===true) {
                    $module = $_GET['module'];
                  }else{
                    $module = "Access_Denied";
                  }
            }else{
              // $module = $navBar->get_first_module_page($user->username);
              $module ='Change_Language';
              // echo var_dump($module);
            }
            // echo $module;

            if ($language==='ar') {
              include "modules/". $module ."/lang/ar.php";
            } else {
              include "modules/". $module ."/lang/en.php";
            }
             
              include("modules/" . $module . "/config/default.conf.php");
              getScripts("pageTitle", $module);


            include("lib/headScript.php");



            ////////////////////////////    
            // getting page Scripts  
            /////////////////////////////

              
              getScripts("mainScript", $module);

              include("lib/headScript2.php");
              

            ?>
            

      </head>

    

    <body class="fix-header fix-sidebar card-no-border">
        <!-- ============================================================== -->
        <!-- Preloader - style you can find in spinners.css -->
        <!-- ============================================================== -->
        <div class="preloader">
            <svg class="circular" viewBox="25 25 50 50">
                <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" /> </svg>
        </div>
        <!-- ============================================================== -->
        <!-- Main wrapper - style you can find in pages.scss -->
        <!-- ============================================================== -->
        <div id="main-wrapper">

            <!-- ============================================================== -->
            <!-- Topbar header - style you can find in pages.scss -->
            <!-- ============================================================== -->

            <?php  

            include("lib/headerTopbar.php");

            ?>
             


            <!-- ============================================================== -->
            <!-- End Topbar header -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- Left Sidebar - style you can find in sidebar.scss  -->
            <!-- ============================================================== -->

            <?php  

            include("lib/sidebar.php");

            ?>
            


            <!-- ============================================================== -->
            <!-- End Left Sidebar - style you can find in sidebar.scss  -->
            <!-- ============================================================== -->
            <!-- ============================================================== -->
            <!-- Page wrapper  -->
            <!-- ============================================================== -->
            <?php  

            include("modules/".$module."/index.php");



            ?>

            <!-- ============================================================== -->
            <!-- End Page wrapper  -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Wrapper -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->




        <!-- ============================================================== -->
        <!-- footer -->
        <!-- ============================================================== -->
        

        <?php
        include("lib/footer.php");
        ?>

        <!-- ============================================================== -->
        <!-- end footer -->
        <!-- ============================================================== -->


        <!-- ============================================================== -->
        <!-- footer -->
        <!-- ============================================================== -->
        <?php
        include("lib/footerScript.php");
        ?>
        
                

        <!-- ============================================================== -->
        <!-- End footer -->
        <!-- ============================================================== -->       
    <?php
    include("lib/tokenOnTimeValidate.php");
    ?>        
    </body>

    <?php
    getScripts("subScript",$module);
    ?>


</html>